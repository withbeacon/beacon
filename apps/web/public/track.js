var{width:h,height:v}=window.screen,{userAgent:c,doNotTrack:E}=navigator,{title:s,referrer:d}=document,l=`${h}x${v}`,u=E==="1",w=Intl.DateTimeFormat().resolvedOptions().timeZone,{currentScript:o}=document,f=o.getAttribute("data-track-404")==="true";if(!o)throw new Error("[beacon] unable to get the script for beacon analytics");var y=o.getAttribute("data-endpoint")??"/api/collect";function x(){let e=new URL(o.getAttribute("src"));return`${e.protocol}//${e.host}`}var L=x(),p=L+y;if(!(typeof window<"u"&&window.document))throw new Error("[beacon] stopping the execution as not currently on client side");if(window.location.hostname==="localhost")throw new Error("[beacon] stopping the execution as on localhost");if(u)throw new Error("[beacon] not tracking as do not track is enabled");var b=0,a=!1,A=setInterval(()=>{a||(b+=500)},500);async function m(e=window.location.href){let{status:n}=await fetch(e);if(n===404&&f)return;let t={url:e,visitTime:b,screen:l,referrer:d,userAgent:c,title:s,events:i,timezone:w};window.beacon?.before&&window.beacon.before({pathname:window.location.pathname})===null||fetch(p,{method:"POST",body:JSON.stringify(t)})}document.addEventListener("visibilitychange",()=>{document.visibilityState==="hidden"&&m()});var k=document.querySelectorAll("[data-event]"),i={};function T(e,n,t){e={...e,[t+"ed"]:!0},i={...i,[n]:e}}k.forEach(e=>{let n=e.getAttribute("data-event-name"),t=e.getAttribute("data-event"),g={};!n||!t||e.addEventListener(t,()=>T(g,n,t))});window.addEventListener("blur",async()=>{a=!0});window.addEventListener("focus",async()=>{a=!1});window.addEventListener("beforeunload",async()=>{clearInterval(A)});var r="",O=new MutationObserver(()=>{window.location.href!==r&&(r=window.location.href,m(r))});O.observe(document,{subtree:!0,childList:!0});
