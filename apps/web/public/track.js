var{width:h,height:v}=window.screen,{userAgent:s,doNotTrack:E}=navigator,{title:d,referrer:l}=document,u=`${h}x${v}`,w=E==="1",f=Intl.DateTimeFormat().resolvedOptions().timeZone,{currentScript:o}=document,p=o.getAttribute("data-track-404")==="true";if(!o)throw new Error("[beacon] unable to get the script for beacon analytics");var y=o.getAttribute("data-endpoint")??"/api/collect";function x(){let e=new URL(o.getAttribute("src"));return`${e.protocol}//${e.host}`}var L=x(),r=L+y;if(!(typeof window<"u"&&window.document))throw new Error("[beacon] stopping the execution as not currently on client side");if(window.location.hostname==="localhost")throw new Error("[beacon] stopping the execution as on localhost");if(w)throw new Error("[beacon] not tracking as do not track is enabled");var b=0,c=!1,A=setInterval(()=>{c||(b+=500)},500);async function m(e=window.location.href){let{status:n}=await fetch(r);if(n===404&&p)return;let t={url:e,visitTime:b,screen:u,referrer:l,userAgent:s,title:d,events:a,timezone:f};window.beacon?.before&&window.beacon.before({pathname:window.location.pathname})===null||fetch(r,{method:"POST",body:JSON.stringify(t)})}document.addEventListener("visibilitychange",()=>{document.visibilityState==="hidden"&&m()});var k=document.querySelectorAll("[data-event]"),a={};function T(e,n,t){e={...e,[t+"ed"]:!0},a={...a,[n]:e}}k.forEach(e=>{let n=e.getAttribute("data-event-name"),t=e.getAttribute("data-event"),g={};!n||!t||e.addEventListener(t,()=>T(g,n,t))});window.addEventListener("blur",async()=>{c=!0});window.addEventListener("focus",async()=>{c=!1});window.addEventListener("beforeunload",async()=>{clearInterval(A)});var i="",O=new MutationObserver(()=>{window.location.href!==i&&(i=window.location.href,m(i))});O.observe(document,{subtree:!0,childList:!0});
